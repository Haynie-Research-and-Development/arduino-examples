/*
**********************************************************
* CATEGORY	hardware
* GROUP		microcontroller
* AUTHOR	Lance Haynie <lance@hayniemail.com>
* DATE		2015-11-30
* FILE		traffic_light_controller.cpp
* PURPOSE	traffic light controller main application
**********************************************************
* MODIFICATIONS
* 2015-11-30 - LHAYNIE - Initial Version
* 2015-12-01 - LHAYNIE - Updated for ATMEGA standalone
* 2015-12-05 - LHAYNIE - Updated for Eclipse IDE
* 2015-12-17 - LHAYNIE - Updated to use functions.h
**********************************************************
*/
#include "config.h"
#include "functions.h"

void setup() {
  //all signals will either be x or y
  pinMode(X_GREEN, OUTPUT);
  pinMode(X_YELLOW, OUTPUT);
  pinMode(X_RED, OUTPUT);
  pinMode(Y_GREEN, OUTPUT);
  pinMode(Y_YELLOW, OUTPUT);
  pinMode(Y_RED, OUTPUT);

  lightTest();
}

void loop() {
  //turn the x signal to green, and y signal to red
  digitalWrite(X_GREEN, HIGH);
  digitalWrite(Y_RED, HIGH);
  digitalWrite(X_YELLOW, LOW);
  digitalWrite(X_RED, LOW);
  digitalWrite(Y_GREEN, LOW);
  digitalWrite(Y_YELLOW, LOW);

  //leave it that way for 10 seconds
  delay(10000);

  //x yellow
  digitalWrite(X_YELLOW, HIGH);
  digitalWrite(X_GREEN, LOW);

  //leave it yellow for 2 seconds
  delay(2000);

  //short delay of both red for safety
  digitalWrite(X_YELLOW, LOW);
  digitalWrite(X_RED, HIGH);
  delay(1000);

  //turn the x signal to red, and y signal to green
  digitalWrite(X_YELLOW, LOW);
  digitalWrite(X_RED, HIGH);
  digitalWrite(Y_RED, LOW);
  digitalWrite(Y_GREEN, HIGH);


  //leave it there for 10 seconds
  delay(10000);

  //y yellow
  digitalWrite(Y_YELLOW, HIGH);
  digitalWrite(Y_GREEN, LOW);


  //leave it yellow for 2 seconds
  delay(2000);

  //short delay of both red for safety
  digitalWrite(Y_YELLOW, LOW);
  digitalWrite(Y_RED, HIGH);
  delay(1000);
}
